---
title: "projet.Rmd"
author: "William Beaudry"
output: html_document
date: "2024-11-16"
---

# État du savoir

## Sélection des sources bibliographiques
Pour produire cet état du savoir, nous avons eu recours à trois outils numériques de recherche. D'abord, nous avons entré notre question de recherche dans *Perplexity.ai* afin qu'il retravaille la question dans des termes optimaux pour produire une question pour le logiciel *Elicit*. Notre question de recherche « Comment expliquer la faible participation aux élections fédérales dans les Premières Nations du Québec comparativement à celles des autres provinces entre 2004 et 2011 ? » a été traduite ainsi « What factors explain the lower voter turnout in First Nations communities in Quebec compared to other Canadian provinces in federal elections between 2004 and 2011 ? » pour faire une requête dans *Elicit*.

Une fois la requête envoyé dans *Elicit*, nous avons sélectionnés les 16 premiers articles proposés. Ceux-ci étaient filtré en fonction de leur pertinence à répondre à la question de recherche et en fonction de la date. La période pour laquelle était choisi des textes étaient de 2004 à aujourd'hui.

# Méthodes et données
## Méthodologie
## Extraction des données
Pour extraire nos données, nous avons utilisé le *package \rvest*. En grande partie, le processus de création du code R a été un long échange entre la fonctionnalité *R Wizard* de ChatGPT et l'IA *Perplexity.ai*. Le code que nous avons roulé pour extraire les données est le suivant:

**Charger les bibliothèques nécessaires**
library(rvest)
library(dplyr)

**URL de la page**
url <- "https://www.elections.ca/content.aspx?dir=rec/part/fvt&document=p4&lang=f&section=res"

**Lire le contenu HTML de la page**
page <- read_html(url)

**Extraire les lignes du tableau avec les balises "tr"**
table_rows <- page %>%
  html_elements("tr")

**Récupérer le contenu des balises "th" (en-têtes de colonnes)**
headers <- table_rows %>%
  .[1] %>%
  html_elements("th") %>%
  html_text()

**Extraire les données des balises "td" pour les rangées restantes**
data <- table_rows %>%
  .[-1] %>%
  lapply(function(row) {
    row %>% html_elements("td") %>% html_text()
  })

**Convertir les données en data frame**
df <- do.call(rbind, data) %>%
  as.data.frame(stringsAsFactors = FALSE)

**Attribuer les noms de colonnes extraits**
names(df) <- headers

**Nettoyer et convertir les données numériques**
df_cln <- df %>%
  mutate(across(
    .cols = -1, 
    .fns = ~ {
      # Supprimer les espaces et remplacer la virgule par un point
      cleaned <- gsub(" ", "", .)
      cleaned <- gsub(",", ".", cleaned)
      # Convertir en numérique
      as.numeric(cleaned)
    }
  ))

Ce code nous a permit de créer une tableau des taux de participation des communautés autochtones aux élections fédérales de 2004 à 2011 ventilé selon la province.

# Résultats
## Visualisation
Nous avons fait le choix de faire deux visualisation avec les données que nous avons extraites. La première visualisation est un graphique à ligne brisée pour montrer les tendances propres aux communautés de chaque provinces. Le second graphique est un diagramme en points. Il permet d'observer la différence importante de participation entre les communautés autochtones du Québec et celle des autres provinces canadiennes. Le code que nous avons roulé pour produire ces graphiques sont les suivants:

**Préparer les données**
df_long <- df_cln %>%
  pivot_longer(cols = -"Province/territoire", names_to = "Année", values_to = "Taux_participation")

**Graphique linéaire**
ggplot(df_long, aes(x = Année, y = Taux_participation, group = `Province/territoire`, color = `Province/territoire`)) +
  geom_line() +
  geom_point() +
  theme_minimal() +
  labs(
    title = "Taux de participation aux élections fédérales par province (2004-2011)",
    x = "Année", y = "Taux de participation (%)",
    color = "Province"
  ) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    legend.position = "right"
  ) +
  scale_color_manual(values = couleurs)

**Créer un graphique boxplot**
ggplot(df_long, aes(x = Année, y = Taux_participation, group = "Province/territoire", color = "Province/territoire")) +
  geom_line() +
  geom_point() +
  theme_minimal() +
  labs(title = "Taux de participation aux élections fédérales par province (2004-2011)",
       x = "Année", y = "Taux de participation (%)",
       color = "Province") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        legend.position = "right") +
  scale_color_manual(values = "red")

# Discussion
